#!/bin/sh
MAKEMAKE=opp_makemake
OPTS="-f -N"
#OPTS="-N"

# note: $(ROOT) will come from ipsuiteconfig at build time
ALL_IPSUITE_INCLUDES='-I$(ROOT)/Network/IPv4/Core -I$(ROOT)/Network/IPv4/QoS -I$(ROOT)/Transport/TCP -I$(ROOT)/Transport/UDP -I$(ROOT)/Transport/Socket -I$(ROOT)/NetworkInterfaces -I$(ROOT)/NetworkInterfaces/PPP-old -I$(ROOT)/NetworkInterfaces/Queues -I$(ROOT)/Applications/Generic -I$(ROOT)/Applications/TCPApp -I$(ROOT)/Applications/UDPApp -I$(ROOT)/Applications/PingApp -I$(ROOT)/Base -I$(ROOT)/Util -I$(ROOT)/Nodes/IPSuite'
ALL_MPLS_INCLUDES=$ALL_IPSUITE_INCLUDES' -I$(ROOT)/Network/MPLS -I$(ROOT)/Network/LDP -I$(ROOT)/Network/RSVP_TE -I$(ROOT)/Nodes/MPLS'

: #--------------------------------------

$MAKEMAKE $OPTS -n -r -c ipsuiteconfig

(cd Applications && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig)
(cd Examples && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig)
(cd Tests && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig)
(cd Network && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig)
(cd NetworkInterfaces && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig -IQueues)
(cd Nodes && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig)
(cd PHY && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig)
(cd Transport && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig)
(cd Base && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig)
(cd Util && $MAKEMAKE $OPTS -n -r -c ../ipsuiteconfig)

(cd Applications/Generic && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../../Network/IPv4/Core -I../../Base)
(cd Applications/PingApp && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../../Network/IPv4/Core -I../../Base)
(cd Applications/TCPApp && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../../Network/IPv4/Core -I../../Transport/TCP -I../../Base)
(cd Applications/UDPApp && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../../Network/IPv4/Core -I../../Transport/TCP -I../../Transport/UDP -I../../Base)

(cd Examples/IPSuite && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig)
(cd Examples/MPLS && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig)

(cd Examples/IPSuite/KIDSNw1 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_IPSUITE_INCLUDES)
(cd Examples/IPSuite/McNetwork2 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_IPSUITE_INCLUDES)
(cd Examples/IPSuite/PerformAnalysis && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_IPSUITE_INCLUDES)
(cd Examples/IPSuite/TCPClientServerNet && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_IPSUITE_INCLUDES)
(cd Examples/IPSuite/TCPTester && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_IPSUITE_INCLUDES)
(cd Examples/IPSuite/TCPUDPDirectNet && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_IPSUITE_INCLUDES)
(cd Examples/IPSuite/UDPSockets && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_IPSUITE_INCLUDES)

(cd Examples/MPLS/Tester && $MAKEMAKE $OPTS -n -r -c ../../../ipsuiteconfig $ALL_MPLS_INCLUDES)
(cd Examples/MPLS/demo2 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_MPLS_INCLUDES )
(cd Examples/MPLS/ldp-mpls1 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_MPLS_INCLUDES )
(cd Examples/MPLS/samples && $MAKEMAKE $OPTS -n -r -c ../../../ipsuiteconfig)
(cd Examples/MPLS/TestTE1 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig -I../Tester $ALL_MPLS_INCLUDES )
(cd Examples/MPLS/TestTE2 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig -I../Tester $ALL_MPLS_INCLUDES )
(cd Examples/MPLS/TestTE3 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig -I../Tester $ALL_MPLS_INCLUDES )
(cd Examples/MPLS/TestTE4 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig -I../Tester $ALL_MPLS_INCLUDES )
(cd Examples/MPLS/TestTE4Old && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig -I../Tester $ALL_MPLS_INCLUDES )
(cd Examples/MPLS/TestTE5 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig -I../Tester $ALL_MPLS_INCLUDES )
(cd Examples/MPLS/TestTE6 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig -I../Tester $ALL_MPLS_INCLUDES )

(cd Tests/MPLS && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig)
(cd Tests/MPLS/LDP1 && $MAKEMAKE $OPTS -w -c ../../../ipsuiteconfig $ALL_MPLS_INCLUDES )

(cd Network/IPv4 && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig)
(cd Network/MPLS && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../IPv4/Core -I../../Transport/TCP -I../../Base)
(cd Network/LDP && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../IPv4/Core -I../../Transport/TCP -I../../Transport/UDP -I../MPLS -I../../Base)
(cd Network/RSVP_TE && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../IPv4/Core -I../../Transport/TCP -I../MPLS -I../../Base)
(cd Network/IPv4/Core && $MAKEMAKE $OPTS -n -r -c ../../../ipsuiteconfig -I../../../NetworkInterfaces -I../../../NetworkInterfaces/Queues -I../../../Base)
(cd Network/IPv4/QoS && $MAKEMAKE $OPTS -n -r -c ../../../ipsuiteconfig -I../Core -I../../../Transport/TCP -I../../../Base)

(cd NetworkInterfaces/PPP-old && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../../Base -I../../Network/IPv4/Core)
(cd NetworkInterfaces/Queues && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../../Base -I../../Network/IPv4/Core -I../../Network/IPv4/QoS)

(cd Nodes/IPSuite && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../../Network/IPv4/Core -I../../Network/IPv4/QoS -I../../Transport/TCP -I../../Transport/UDP -I../../NetworkInterfaces/PPP-old -I../../NetworkInterfaces -I../../NetworkInterfaces/Queues  -I../../Applications/Generic -I../../Applications/TCPApp -I../../Applications/UDPApp -I../../Applications/PingApp -I../../Base)
(cd Nodes/MPLS && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../../Network/IPv4/Core -I../../Network/IPv4/QoS -I../../Network/MPLS -I../../Network/LDP -I../../Network/RSVP_TE -I../../Transport/TCP -I../../Transport/UDP -I../../NetworkInterfaces/PPP-old -I../../NetworkInterfaces -I../../NetworkInterfaces/Queues  -I../../Applications/Generic -I../../Applications/TCPApp -I../../Applications/PingApp -I../IPSuite -I../../Base)

(cd Transport/Socket && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../TCP -I../../Network/IPv4/Core -I../../Base)
(cd Transport/TCP && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../../Network/IPv4/Core -I../../Applications/TCPApp -I../../Base)
(cd Transport/UDP && $MAKEMAKE $OPTS -n -r -c ../../ipsuiteconfig -I../TCP -I../../Network/IPv4/Core -I../../Base)

