<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="../../samples.css">
<title>Routing Table Visualization Example</title>
</head>

<body>

<h1><center>Routing Table Visualization Example</center></h1>

<h2>Goals</h2>

<p>
Visualizing how packets are routed in a network can be useful because a lot of information about routes is presented at a glance in a concise way. When routes are visualized, there is no need to examine individual routing tables, and sift through difficult to understand numeric data.
This example demonstrates how routes can be visualized.
</p>

<p>The example consists of 3 simulation models of increasing complexity, each demonstrating different features of routing table visualization</p>

<h2>About the visualizer</h2>

<p>
The <code><strong>RoutingTableVisualizer</strong></code> module can be used for this purpose.
The <code><strong>RoutingTableVisualizer</strong></code> module visualizes routing table entries in the following way. Routing table entries are represented visually by solid arrows.
An arrow going from a source node represents a routing table entry in the source node's routing table. The endpoint node of the arrow is the nexthop in
the visualized routing table entry.
Note that in the terminology of this example, the word <i>route</i> means <i>routing table entry</i>. TODO: do we need this?
Could be used interchangably. For example, routes can lead from somewhere to somewhere, but routing table entries cannot (?)
</p>

<p>
The visualizer has a <i>destinationFilter</i> parameter, which specifies the destination node of the visualization.
The rule that best matches this destination in each node's routing table is visualized by the arrows.
By default, all routes are visualized towards all destinations. This means that for each destination, the best matching rule in a given node's routing talbe is visualized as an arrow. TODO: do we need this? Rewrite
The <i>nodeFilter</i> parameter controls which nodes' routing tables should be visualized.
</p>

<p>
The visualizer reacts to changes in the routing tables it is set to visualize, and updates the visualizations.
It also reacts to IP address changes. These changes can have an effect on routes, because another routing table entry might become the
best matching rule.
</p>

<h2>1. Displaying all routing tables</h2>

<p>This configuration demonstrates how to enable the visualization of routes, and how the visualization looks like.
<p>
The network for this configuration contains 2 <code><strong>StandardHosts</strong></code> connected with a 100Mbit/s ethernet cable, an <code><strong>IPv4Configurator</strong></code> module and a <code><strong>RoutingTableVisualizer</strong></code> module.
The configuration contains one entry, which enables the visualization of routing tables with the <i>displayRoutingTables</i> parameter.
All other parameters of the visualizer is left on default. TODO: do we need what cable they are connected with? Do we need it in the other configs?
</p>

<p>When the simulation is run, the network looks like this:</p>

<img src="displayroutes.png">

<p>
In this simple network, there are just two routes (<code><strong>HostA -> HostB</strong></code>, and <code><strong>HostB -> HostA</strong></code>).
There are separate arrows for the two directions.
</p>

<p>Note that you can double click on an arrow, and the corresponding routing table comes up in an inspector window.</p>

<h2>2. Filtering routing table entries</h2>

<p>
The goal of this configuration is to demonstrates the use of the <i>nodeFilter</i> and <i>destinationFilter</i> parameters.
</p>

<p>
The network for this configuration look like the following:
</p>

<img src="filtersnetwork.png">

<p>
It consists of a router connected to a switch. Two <code><strong>StandardHosts</strong></code> are connected to the switch, and another two <code><strong>StandardHosts</strong></code> are connected to the router. The visualizer module is <code><strong>IntegratedVisualizer</strong></code>, which contains all visualizers as submodules.
</p>

</p>
The goal is to only visualize the routes going from <code><strong>host2</strong></code> towards <code><strong>host3</strong></code>.
To this end, the <i>destinationFilter</i> parameter is set to <code><strong>host3</strong></code>.
To narrow the visualized routes down to the ones that lead from <code><strong>host2</strong></code>, the <i>nodeFilter</i> parameter
is specified as <code><strong>"not(host1 or host4)"</strong></code>. This instructs the visualizer not to visualize the routing tables of <code><strong>host1</strong></code> and <code><strong>host4</strong></code>.
The routing table of <code><strong>router</strong></code> needs to be visualized, because the path from <code><strong>host2</strong></code> to <code><strong>host3</strong></code> leads through it.
</p>

<p>This is what the visualized routes look like:</p>

<img src="routes.png">

<p>The defaults of the <code><strong>nodeFilter</strong></code> and <code><strong>destinationFilter</strong></code> parameters is <code><strong>"*"</strong></code>, which means all routes from all nodes towards
all destinations are visualized. The network would look like the following with these default settings:</p>

<img src="fullmesh.png">

<p>
Note that the arrows don't go through the switch. This is because L2 devices like switches and access points don't have network layers, thus don't have IP addresses or routing tables. They are
effectively transparent for the route visualization arrows (the visualizer could, in theory, know that the packets will take a path that goes through
the switch. This is true in this situation, but in others there may be multiple interconnected switches, and more paths that the packets can take.
However, the pathfinding in that case is not a network layer level problem).
</p>

<h2>3. Visualizing changing routing tables</h2>

<p>
The visualizer reacts to changes in the routing table of hosts selected with the <i>nodeFilter</i> parameter.
These routing table changes are due to a dynamic routing protocol like AODV, or changes in IP addresses due to DHCP, for example. In this configuration, the
routing tables are changed by AODV (Advanced On-Demand Vector Routing Protocol).
</p>

<p>
Here is the network for this configuration:
</p>

<img src="dynamicnetwork.png">

<p>
The network contains a series of <code><strong>AODVRouters</strong></code>. These are mobile hosts that have AODV and
IP forwarding enabled. 6 of the hosts are laid out in a chain, and are stationary.
Their communication ranges are specified so that each host can only reach the adjacent hosts.
The <code><strong>destinationHost</strong></code> hosts moves up and down along the chain, and is only in the communication range
of the 1 or 2 nearby hosts.
</p>

<p>
Since routes are determined dynamically by the AODV protocol, the configurator is instructed not to add static routes.
The visualizer module is <code><strong>IntegratedVisualizer</strong></code>.
</p>

<p>
<code><strong>sourceHost</strong></code> is configured to ping <code><strong>destinationHost</strong></code>. Since each host is capable of reaching the adjacent hosts only, the ping
packets are relayed to <code><strong>destinationHost</strong></code> through the chain. As the network topology changes because of node mobility, the AODV protocol dynamically configures the routes, in order
for the ping packets to reach <code><strong>destinationHost</strong></code>.
</p>

<p>The following animation depicts what happens when the simulation is run.</p>

<img src="routingtablevisualizer2.gif">

<p>When <code><strong>destinationHost</strong></code> starts to move downwards, packets get routed across the chain to the host that is currently adjacent to <code><strong>destinationHost</strong></code>. This host relays the packets to <code><strong>destinationHost</strong></code>. When <code><strong>destinationHost</strong></code> reaches the bottom of the playground
and turns back, the routes leading to it from the lower hosts don't change. This is because AODV is an on-demand protocol, thus routes are only changed when it is required. On the way back, the lower hosts are not taking part of the packet relay, and the unused routes remain in their routing tables. When <code><strong>destinationHost</strong></code> gets to the top of the
playground, the process starts again. Routes are dynamically configured by AODV to relay the packets across the chain to <code><strong>destinationHost</strong></code>. The visualizer reacts to the changes in the routing tables, and updates the visualization accordingly.

<h2>Conclusion</h2>

This example demonstrated the key features of routing table visualization. For more information on all features and parameters of <code><strong>RoutingTableVisualizer</strong></code>,
refer to the NED documentation. TODO: link to ned doc

</body>
</html>