<html>
<head>
	<title>Power Consumption Example</title>
	<link rel="stylesheet" type="text/css" href="../../etc/samples.css">
</head>
<body>
	<h1><center>Power Consumption Example</center></h1>

	<p><h2>Goals</h2></p>

	<p>
		This example demonstrates consumption, storage and generation of power in mobile wireless hosts.
		The hosts will send out ping requests, which will deplete their power storage, while their power generators will charge them.
	</p>

	<p><h2>The model</h2></p>

	<p><b>The network</b></p>

	<p>
		The network contains mobile hosts (type <tt>AdhocHost</tt>), the number of which can be specified in <i>omnetpp.ini</i>.
		The default number specified is 20. They are randomly placed on the playground, and they're static (they don't move around).
	</p>

	<p><center><img src="network2.png"></center></p>

	<p><b>Configuration and behavior</b></p>

	<p>
		All hosts will send ping requests to Host 0. Host 0 doesn't send ping requests, just replies to the requests that it receives. The radio transmissions will deplete the hosts' energy storage.
	</p>

	<p>
		Each host has a nominal energy storage capacity of 0.05 Joules. The charge they contain at the beginning of the simulation is randomly selected between
		0 and the nominal capacity. Hosts shut down when their energy storage reaches 0, and restart when their energy storage charges to half of the nominal capacity,
		that is 0.025 Joules.
	</p>

	<p>
		The hosts contain an <tt>AlternatingEnergyGenerator</tt>. This alternates between generation and sleep modes. It starts in generation mode, and generates the amount of power
		that is specified by its <i>powerGeneration</i> parameter (now set to 1 mW). In sleep mode, it generates no power. It stays in each mode for the duration specified by the
		<i>generationInterval</i> and <i>sleepInterval</i> parameters. These are set to a random value with a mean of 10s.
	</p>

	<p><h2>Results</h2></p>

	<p>
		Each host (except host 0) transmits a ping request frame every second. The time when they start sending them is a random value for each host, between 0 and 1 seconds. 
		This means that they don't start sending the requests simultaneously. Also, ping packets are short, and hosts send them very infrequently. This greatly decreases the 
		probability of collisions. Host 0 acts as the target for the ping requests of all the other hosts.
		Host 0 replies with a ping reply frame. Both the ping request and the ping reply frames are followed by an ACK from the receiving host.
	</p>

	<p>
		After a while, the energy storage in hosts get depleted, and the hosts shut down. This is indicated by a red x on the host's symbol.
		The energy generator charges hosts regardless of whether they are depleted or not (as if they were charged by a solar panel).
	</p>

	<p><center><img src="depleted.png"></center></p>

	<p>
		The following chart shows the energy storage levels (<i>residualCapacity</i>) of all the hosts through the course of the simulation.
		In general, hosts start from a given charge level, and their energy storage level depletes, and reaches zero.
		When that happens, the hosts shut down. Then they start to charge, and when their charge level reaches the 0.025J threshold, they turn back on.
		They continue sending ping requests, until they get depleted again.
	</p>

	<p><center><img src="residualcapacity.png" width=900px></center></p>

	<p>
		The following chart shows the energy storage level (red curve) and the energy generator output (blue curve) of Host 14. The intervals when the generator is charging the energy storage
		can be discerned on the energy storage graph as varying slopes. When the host is transmitting and the generator is charging, the energy levels don't decrease as fast.
	</p>

	<p><center><img src="host14.png" width=900px></center></p>

	<p>
		Host 0 is different from the other hosts in that it doesn't generate ping requests, but sends replies to all the ping requests it receives. Therefore it consumes energy
		faster. As other hosts just send one ping request as second, Host 0 has to reply to 20 each second. This increased consumption can be seen on the following energy consumption graph
		as more rapidly decreasing curve.
	</p>

	<p><center><img src="consumption.png" width=900px></center></p>


</body>