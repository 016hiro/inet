\chapter{Network Interfaces}
\label{cha:network-interfaces}

\section{Overview}

%TODO: MAC address, op mode, duplex mode, data rate, transmission power, queue limits, FCS mode

In INET simulations, network interface modules are the primary means of
communication between network nodes. They represent the required
combination of software and hardware elements from an operating system
point-of-view. Network interfaces come in two quite different kinds: wired
and wireless.

Wired interfaces have a pair of special purpose OMNeT++ gates which represent
the capability of having an external physical connection to another network
node (e.g., Ethernet port). In order to make wired communication work,
these gates must be connected with special connections which represent the
physical cable between the physical ports. The connections must use special
OMNeT++ channels (e.g., \nedtype{DatarateChannel}) which determine datarate
and delay parameters.


\section{Built-in Network Interfaces}

INET provides pre-assembled network interfaces for several standard
protocols, protocol tunneling, hardware emulation, etc. The following list
gives the most commonly used network interfaces.

\begin{itemize}
        \item \nedtype{EthernetInterface} contains \protocol{Ethernet} MAC and PHY protocols
        \item \nedtype{PppInterface} provides \protocol{PPP} protocol
        \item \nedtype{Ieee80211Interface} contains \protocol{IEEE 802.11} MGMT, MAC and PHY protocols
        \item \nedtype{Ieee802154Interface} contains \protocol{IEEE 802.15.4} MAC and PHY protocols
        \item \nedtype{BMacInterface}, \nedtype{LMacInterface}, \nedtype{XMacInterface} provides low-power wireless sensor protocols along with a simple hypothetical PHY protocol
        \item \nedtype{TunInterface} provides protocol tunneling which can be directly used by applications
        \item \nedtype{LoopbackInterface} provides local loopback within the network node
        \item \nedtype{ExtInterface} represents real interfaces suitable for hardware-in-the-loop simulations
\end{itemize}

The internal structure of network interfaces can also be customized in
several ways similarly to network nodes. For example,
\nedtype{EthernetInterface} contains optional submodules for queuing and
traffic shaping.

\section{Network Interface Structure}

All network interfaces in the INET Framework are OMNeT++ compound modules that
are mainly composed of the following components:

\begin{itemize}
        \item \emph{LLC protocols}
        \item \emph{MGMT protocols}
        \item \emph{MAC protocols}
        \item \emph{PHY protocols}
        \item \emph{Traffic conditioners}
        \item \emph{Queues}
        \item \emph{Classifiers}
\end{itemize}

\section{Queueing}

TODO internal/external queue

TODO injecting errors (via IHooks)

TODO generalize this: 

The PPP module receives packets from the upper layer in the \fvar{netwIn}
gate, encapsulates them into \msgtype{PppFrame}s, and send it to the
physical layer through the \fvar{phys} gate. The \msgtype{PppFrame}s
received from the \fvar{phys} gate are decapsulated and sent to the upper
layer immediately through the \fvar{netwOut} gate.

Incoming datagrams are waiting in a queue if the line is currently busy.
In routers, PPP relies on an external queue module (implementing
\nedtype{IOutputQueue}) to model finite buffer, implement QoS and/or RED,
and requests packets from this external queue one-by-one. The name
of this queue is given as the \fpar{queueModule} parameter.

In hosts, no such queue is used, so \nedtype{Ppp} contains an internal
queue named txQueue to queue up packets wainting for transmission.
Conceptually txQueue is of inifinite size, but for better diagnostics
one can specify a hard limit in the \fpar{txQueueLimit} parameter -- if
this is exceeded, the simulation stops with an error.

The module can be used in simulations where the nodes are connected and
disconnected dinamically. If the channel between the PPP modules is down,
the messages received from the upper layer are dropped (including the messages
waiting in the queue). When the connection is restored it will
poll the queue and transmits the messages again.

The PPP module registers itself in the interface table of the node.
The \fvar{mtu} of the entry can be specified by the
\fpar{mtu} module parameter. The module checks the state of the physical link
and updates the entry in the interface table.


\section{Wired Network Interfaces}

%TODO: explain what is specific to wired interfaces

\section{Wireless Network Interfaces}

%TODO: explain what is specific to wireless interfaces

\section{Custom Network Interfaces}

It's also possible to build custom network interfaces, the following
example shows how to build a custom wireless interface.

\nedsnippet{WirelessInterfaceExample}{Wireless interface example}

The above network interface contains very simple hypothetical MAC and PHY
protocols. The MAC protocol only provides acknowledgment without other
services (e.g., carrier sense, collision avoidance, collision detection),
the PHY protocol uses one of the predefined APSK modulations for the whole
signal (preamble, header, and data) without other services (e.g.,
scrambling, interleaving, forward error correction).


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "usman"
%%% End:


